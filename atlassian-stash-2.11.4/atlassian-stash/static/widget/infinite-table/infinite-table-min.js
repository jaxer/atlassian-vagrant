define("widget/infinite-table",["aui","jquery","underscore","util/ajax","util/deprecation","widget/paged-scrollable","widget/loaded-range"],function(A,F,B,E,D,H,C){function G(J,I){H.call(this);this.$table=F(J).addClass("infinite-table");this.$tbody=this.$table.children("tbody");if(!this.$tbody.length){this.$tbody=this.$table}this._options=F.extend({},G.defaults,I)}F.extend(G.prototype,H.prototype);G.prototype.init=function(I){I=I||{start:this.$table.data("start"),size:this.$table.data("size"),isLastPage:this.$table.data("is-last-page"),nextPageStart:this.$table.data("next-page-start")};H.prototype.init.call(this,{loadedRange:new C().add(I.start,I.size,I.isLastPage,I.nextPageStart)})};G.prototype.requestData=function(K,I){var J=F('<div class="spinner"/>');this.$table.after(J);J.spin("large");return E.rest({url:this._options.getRequestUrl(K,I)}).always(function(){J.spinStop();J.remove()})};G.prototype.attachNewContent=function(J,I){var K=this._options.resultTemplate;this.$tbody[I](B.map(J.values,K).join(""));if(J.isLastPage){F("<p class='no-more-results'/>").text(this._options.noMoreMessage).insertAfter(this.$table)}};G.defaults={getRequestUrl:function(J,I){A.log("getRequestUrl must be specified to use InfiniteTable.")},noMoreMessage:stash_i18n("stash.web.results.no.more","No more results"),resultTemplate:function(K){var J="<tr>";for(var I in K){if(Object.prototype.hasOwnProperty.call(K,I)){J+="<td>"+A.escapeHtml(K[I])+"</td>"}}J+="</tr>";return J}};return D.construct(G,"InfiniteTable","widget/paged-table","2.4","3.0")});