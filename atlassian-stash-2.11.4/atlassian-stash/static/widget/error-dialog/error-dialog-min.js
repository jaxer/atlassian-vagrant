define("widget/error-dialog",["aui","jquery"],function(B,C){function A(E){this._okCallbacks=C.Callbacks();this._closeCallbacks=C.Callbacks();this.reinit(E);var D=this;C(document).bind("hideLayer",function(F,G){if(D._dialog&&D._dialog.popup===G){D.hide()}})}A.prototype.reinit=function(D){this.dialogOptions=C.extend({},A.dialogDefaults,D);return this};A.prototype._createDialog=function(){if(!this._dialog){var D=this,F=this.dialogOptions,E=this._dialog=new B.Dialog({width:433,height:230,id:F.id,closeOnOutsideClick:F.closeOnOutsideClick,keypressListener:function(H){if(H.keyCode===C.ui.keyCode.ESCAPE){D.hide()}}}),G=this._okCallbacks;E.popup.element.addClass("error-dialog");E.addHeader(F.titleText,F.titleClass);E.addPanel("",F.panelContent,F.panelClass);E.addButton(F.okButtonText,function(H){var I=C.Event("ok");G.fireWith(D,[I]);if(!I.isDefaultPrevented()){D.remove()}},"button "+(F.okButtonClass||""));if(F.showCloseButton){E.addCancel(F.closeButtonText,function(H){D.remove()})}}};A.prototype.show=function(){this._createDialog();this._dialog.show();return this};A.prototype.isShowing=function(){return this._dialog&&this._dialog.popup.element.is(":visible")};A.prototype.hide=function(){if(this.isShowing()){this._dialog.hide();this._closeCallbacks.fireWith(this,[])}return this};A.prototype.remove=function(){if(this._dialog){this.hide();this._dialog.remove();this._dialog=null}return this};A.prototype.addOkListener=function(D){this._okCallbacks.add(D);return this};A.prototype.addHideListener=function(D){this._closeCallbacks.add(D);return this};A.prototype.getOkButton=function(){this._createDialog();return this._dialog.popup.element.find("."+this.dialogOptions.okButtonClass)};A.dialogDefaults={id:undefined,titleText:stash_i18n("stash.web.dialog.unexpected.error.title","Unexpected Error"),titleClass:"error-header",panelContent:"<p>"+stash_i18n("stash.web.dialog.unknown.error.detail","An unexpected error has occurred. If the problem persists, contact your administrator.")+"</p>",panelClass:"panel-body",okButtonText:stash_i18n("stash.web.dialog.button.ok","OK"),okButtonClass:"ok-button",showCloseButton:false,closeButtonText:stash_i18n("stash.web.dialog.button.close","Close"),closeOnOutsideClick:false};return A});