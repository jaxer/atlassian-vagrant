define("feature/comments",["jquery","feature/comments/diff-comment-context","feature/comments/activity-comment-context","feature/comments/anchors","feature/comments/comment-tips"],function(E,D,A,C,F){var B={CREATE_NEW:"create-new",REPLY_ONLY:"reply-only",READ:"read",NONE:"none"};return E.extend({bindContext:function(L,H,G){if(L.data("comment-context")){throw new Error("Duplicate comment context registered.")}var K=G&&(G.commentMode===B.READ||G.commentMode===B.CREATE_NEW||G.commentMode===B.REPLY_ONLY);var J=G&&G.commentMode===B.CREATE_NEW;G=E.extend({el:L[0],anchor:H,allowCommenting:J,showComments:K},G);var I=H instanceof C.DiffAnchor?new D(G):new A(G);L.data("comment-context",I);return I},updateContext:function(H){var G=H.data("comment-context");if(G){G.checkForNewContainers()}},unbindContext:function(H){var G=H.data("comment-context");if(G){G.destroy()}},commentMode:B},C,F)});