define("feature/repository/branch-diagram",["jquery","underscore","model/repository","model/revision-reference"],function(D,C,B,E){function A(F){this.$el=D(F)}A.prototype._updateRefLozenge=function(J,F,H){var K=this.$el.find("."+J);K.trigger("mouseout");if(F&&F instanceof E){if(!F.getDisplayId()&&!F.getId()){K.addClass("invisible")}else{var I=stash.feature.repository.refLozenge({ref:F.toJSON(),repository:(H&&H instanceof B)?H.toJSON():null,extraClasses:J});if(K.length){K.replaceWith(I).removeClass("invisible")}else{this.$el.append(I)}}}else{if(F==null||F===""){K.addClass("invisible")}}var G=this.$el.find(".source-ref").length&&this.$el.find(".target-ref").length;this.$el.toggleClass("disabled",!G)};A.prototype.updateSourceRef=C.partial(A.prototype._updateRefLozenge,"source-ref");A.prototype.updateTargetRef=C.partial(A.prototype._updateRefLozenge,"target-ref");return A});