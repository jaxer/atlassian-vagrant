define("feature/ediff",["util/deprecation","feature/file-content/ediff"],function(A,B){A.getMessageLogger("feature/ediff","feature/file-content/ediff","2.10","3.0")();return B});define("feature/file-content/ediff",["util/html"],function(R){var O=/\w+|\s+|./gim,C=/\n[ \u00a0\t\r]+/mg,U=/\s/m,Q="add",V="delete",I="change",E=R.NodeStream,D=R.NodeType,J=D.OPEN,H=D.CLOSE;function P(Y){var W=[],X;O.lastIndex=0;while(X=O.exec(Y)){W.push({start:X.index,value:X[0],end:O.lastIndex})}return W}function L(W){var Y=W.comparableValue,X;if(typeof Y!=="string"){X=Y=W.value;U.lastIndex=0;if(U.test(X)){if(W.start===0){X="\n"+X}if(X.indexOf("\n")!==-1){Y=X.replace(C,"\n")}}W.comparableValue=Y}return Y}function F(W,c){var Y=[];if(W.length!==0||c.length!==0){var e=A(W,c);if(e.snake){e=e.prev}while(e&&e.prev&&e.prev.j>=0){if(e.snake){throw"bad diffpath: found snake when looking for diff"}var a=e.i;var Z=e.j;e=e.prev;var X=e.i;var f=e.j;var b=a-X;var d=Z-f;Y.unshift({from:X,fromCount:b,to:f,toCount:d,type:(b===0&&Q)||(d===0&&V)||I});if(e.snake){e=e.prev}}}return Y}function A(Y,n){var h=Y.length,m=n.length,c=h+m+1,p=1+2*c,q=(p+1)/2,X=[];X.length=p;X[q+1]=N(0,-1,null);for(var l=0;l<c;l++){for(var e=-l;e<=l;e+=2){var o=q+e,a=o+1,W=o-1,b,g;if((e===-l)||(e!==l&&X[W].i<X[a].i)){g=X[a].i;b=X[a]}else{g=X[W].i+1;b=X[W]}X[W]=null;var f=g-e;var Z=M(g,f,b);while(g<h&&f<m&&(L(Y[g])===L(n[f]))){g++;f++}if(g>Z.i){Z=N(g,f,Z)}X[o]=Z;if(g>=h&&f>=m){return X[o]}}X[q+l-1]=null}throw"could not find a diff path"}function N(X,W,Y){return{i:X,j:W,prev:Y,snake:true}}function M(X,W,Y){return{i:X,j:W,prev:B(Y)}}function B(W){while(W&&W.i!==0&&W.j!==0&&!W.snake){if(!W.prev){return W}W=W.prev}return W}function T(c,Z,W,b,d){for(var a=W;a<W+b;a++){var e=Z.length-1;var Y=Z.length&&Z[e];var X=c[a];if(Y&&Y.end===X.start){Z[e]={start:Y.start,end:X.end,type:Y.type}}else{Z.push({start:X.start,end:X.end,type:d})}}}function S(X,c,W){var d=[],e=[];for(var b=0,Y=W.length,a,Z;b<Y;b++){a=W[b];Z=a.type;if(Z===I||Z===V){T(X,d,a.from,a.fromCount,Z)}if(Z===I||Z===Q){T(c,e,a.to,a.toCount,Z)}}return{originalRegions:d,revisedRegions:e}}function K(W,X){var Y=F(W,X);return S(W,X,Y)}function G(W){this._regions=W.slice(0);this._regionsLength=this._regions.length;this._opened=false;this._nextPosition=0;this._current=undefined}G.prototype=new E();G.prototype.hasNext=function(){return this._opened||this._nextPosition<this._regionsLength};G.prototype.next=function(){if(!this.hasNext()){return null}else{if(this._opened){this._opened=false;return{type:H,textPosition:this._current.end,value:"</span>"}}else{this._opened=true;var W=this._current=this._regions[this._nextPosition];this._nextPosition++;return{type:J,textPosition:W.start,value:'<span class="ediff-'+W.type+'">',close:{type:H,value:"</span>"}}}}};G.prototype.getNextType=function(){return this.hasNext()?(this._opened?H:J):null};G.prototype.getNextTextPosition=function(){return this.hasNext()?(this._opened?this._current.end:this._regions[this._nextPosition].start):null};return{tokenizeString:P,getTokensComparableValue:L,diff:K,DiffRegionNodeStream:G}});