define("feature/pull-request-list-dialog",["jquery","aui","util/ajax","util/events","util/navbuilder","model/page-state","widget/avatar-list","feature/pull-request/pull-request-table"],function(D,F,J,A,Q,H,L,N){var P;var I;function K(){return Q.rest().currentRepo().allPullRequests()}function C(){I.initShortcuts();A.on("stash.widget.keyboard-shortcuts.register-contexts",function(S){S.enableContext("pull-request-list")});A.on("stash.keyboard.shortcuts.requestMoveToNextHandler",I.bindMoveToNextHandler);A.on("stash.keyboard.shortcuts.requestMoveToPreviousHandler",I.bindMoveToPreviousHandler);A.on("stash.keyboard.shortcuts.requestOpenItemHandler",I.bindOpenItemHandler);A.on("stash.keyboard.shortcuts.pullrequest.requestHighlightAssignedHandler",I.bindHighlightAssignedHandler)}function R(V,X,T,W,S){var U=new F.Dialog({width:980,height:480,id:"pull-request-list-dialog",closeOnOutsideClick:true}).addHeader(stash_i18n("feature.stash.pullrequest.list.dialog.header","Pull requests"));I=new N(W,S,K,{direction:X,source:T});U.addPanel("",V);U.addCancel(stash_i18n("stash.web.button.close","Close"),_.bind(U.hide,U));return U}function E(){return{principal:H.getCurrentUser().toJSON()}}function G(S){P.getCurrentPanel().html(stash.feature.pullRequest.pullRequestTable({pullRequestPage:S,showStatus:"true",hideAuthorName:"true"},null,E()));I.init();L.init();C();return P}function M(){D(document).off("hideLayer",M);if(P){P.remove();P=null}if(I){I=null}}function B(S){if(S){S.hide()}}function O(S){return J.rest({url:I.buildUrl(0,25)}).fail(function(){B(S)}).done(function(T){G(T);S.updateHeight()})}return{showFor:function(W,T,V,S){M();D(document).on("hideLayer",M);var U=D('<div class="spinner"></div>');P=R(U,W,T,V,S);P.show();U.show().spin("large");O(P).always(function(){U.spinStop().remove()})}}});