(function(){var AE,a,AM,I,p,AD,E,Q,t,AK,AC,AJ,K,G,S,AB,l,AG,i,A,q,J,U,D,j,X,e,n,Z,s,AI,Y,x,O,k,AL,b,N,W,AF,g,AA,z,AH,V,o,F,y,r,M,w,f,AN,T,d,v,h,c,B,C,AP,u,R,P,m=[].slice,AO={}.hasOwnProperty,L=function(AT,AR){for(var AQ in AR){if(AO.call(AR,AQ)){AT[AQ]=AR[AQ]}}function AS(){this.constructor=AT}AS.prototype=AR.prototype;AT.prototype=new AS();AT.__super__=AR.prototype;return AT},H=function(AQ,AR){return function(){return AQ.apply(AR,arguments)}};AE={toString:function(){return"Bacon"}};AE.version="0.7.0";AE.fromBinder=function(AQ,AR){if(AR==null){AR=AP.id}return new AK(AI(AE,"fromBinder",AQ,AR),function(AT){var AS;return AS=AQ(function(){var AV,AX,AW,AZ,AY,AU;AV=1<=arguments.length?m.call(arguments,0):[];AZ=AR.apply(null,AV);if(!(b(AZ)&&AP.last(AZ) instanceof t)){AZ=[AZ]}AW=AE.more;for(AY=0,AU=AZ.length;AY<AU;AY++){AX=AZ[AY];AW=AT(AX=T(AX));if(AW===AE.noMore||AX.isEnd()){if(AS!=null){AS()}else{AE.scheduler.setTimeout((function(){return AS()}),0)}return AW}}return AW})})};AE.$={asEventStream:function(AR,AQ,AS){var AT,AU=this;if(W(AQ)){AT=[AQ,null],AS=AT[0],AQ=AT[1]}return B(this,"asEventStream",AR,AE.fromBinder(function(AV){AU.on(AR,AQ,AV);return function(){return AU.off(AR,AQ,AV)}},AS))}};if((u=typeof jQuery!=="undefined"&&jQuery!==null?jQuery:typeof Zepto!=="undefined"&&Zepto!==null?Zepto:null)!=null){u.fn.asEventStream=AE.$.asEventStream}AE.fromEventTarget=function(AY,AX,AR){var AQ,AS,AW,AV,AU,AT;AQ=(AW=AY.addEventListener)!=null?AW:(AV=AY.addListener)!=null?AV:AY.bind;AS=(AU=AY.removeEventListener)!=null?AU:(AT=AY.removeListener)!=null?AT:AY.unbind;return B(AE,"fromEventTarget",AY,AX,AE.fromBinder(function(AZ){AQ.call(AY,AX,AZ);return function(){return AS.call(AY,AX,AZ)}},AR))};AE.fromPromise=function(AQ,AR){return B(AE,"fromPromise",AQ,AE.fromBinder(function(AS){AQ.then(AS,function(AT){return AS(new Q(AT))});return function(){if(AR){return typeof AQ.abort==="function"?AQ.abort():void 0}}},(function(AS){return[AS,Y()]})))};AE.noMore=["<no-more>"];AE.more=["<more>"];AE.later=function(AQ,AR){return B(AE,"later",AQ,AR,AE.sequentially(AQ,[AR]))};AE.sequentially=function(AS,AQ){var AR;AR=0;return B(AE,"sequentially",AS,AQ,AE.fromPoll(AS,function(){var AT;AT=AQ[AR++];if(AR<AQ.length){return AT}else{if(AR===AQ.length){return[AT,Y()]}else{return Y()}}}))};AE.repeatedly=function(AS,AQ){var AR;AR=0;return B(AE,"repeatedly",AS,AQ,AE.fromPoll(AS,function(){return AQ[AR++%AQ.length]}))};AE.spy=function(AQ){return f.push(AQ)};f=[];w=function(AQ){if(f.length){if(!w.running){try{w.running=true;return AP.each(f,function(AR,AS){return AS(AQ)})}finally{delete w.running}}}};C=function(AQ){return function(){var AS,AT,AU,AR;AU=arguments[0],AS=2<=arguments.length?m.call(arguments,1):[];if(typeof AU==="object"&&AS.length){AT=AU;AR=AS[0];AU=function(){return AT[AR].apply(AT,arguments)};AS=AS.slice(1)}return AQ.apply(null,[AU].concat(m.call(AS)))}};AA=function(AR,AQ){return C(function(){var AS,AT,AU;AT=arguments[0],AS=2<=arguments.length?m.call(arguments,1):[];AU=r(AQ,[function(AV,AW){return AT.apply(null,m.call(AV).concat([AW]))}]);return B.apply(null,[AE,AR,AT].concat(m.call(AS),[AE.combineAsArray(AS).flatMap(AU)]))})};AE.fromCallback=AA("fromCallback",function(){var AQ,AR;AR=arguments[0],AQ=2<=arguments.length?m.call(arguments,1):[];return AE.fromBinder(function(AS){z(AR,AQ)(AS);return y},(function(AS){return[AS,Y()]}))});AE.fromNodeCallback=AA("fromNodeCallback",function(){var AQ,AR;AR=arguments[0],AQ=2<=arguments.length?m.call(arguments,1):[];return AE.fromBinder(function(AS){z(AR,AQ)(AS);return y},function(AS,AT){if(AS){return[new Q(AS),Y()]}return[AT,Y()]})});AE.fromPoll=function(AQ,AR){return B(AE,"fromPoll",AQ,AR,AE.fromBinder((function(AS){var AT;AT=AE.scheduler.setInterval(AS,AQ);return function(){return AE.scheduler.clearInterval(AT)}}),AR))};AE.interval=function(AQ,AR){if(AR==null){AR={}}return B(AE,"interval",AQ,AR,AE.fromPoll(AQ,function(){return F(AR)}))};AE.constant=function(AQ){return new S(AI(AE,"constant",AQ),function(AR){AR(AL(AQ));AR(Y());return y})};AE.never=function(){return B(AE,"never",AE.fromArray([]))};AE.once=function(AQ){return B(AE,"once",AQ,AE.fromArray([AQ]))};AE.fromArray=function(AQ){J(AQ);AQ=e(AQ);return new AK(AI(AE,"fromArray",AQ),function(AS){var AT,AR;AR=false;AT=function(){var AU,AV;if(AP.empty(AQ)){return AS(Y())}else{AV=AQ.splice(0,1)[0];AU=AS(T(AV));if((AU!==AE.noMore)&&!AR){return AT()}}};AT();return function(){return AR=true}})};AE.mergeAll=function(){var AQ;AQ=1<=arguments.length?m.call(arguments,0):[];if(b(AQ[0])){AQ=AQ[0]}return B.apply(null,[AE,"mergeAll"].concat(m.call(AQ),[AP.fold(AQ,AE.never(),(function(AS,AR){return AS.merge(AR)}))]))};AE.zipAsArray=function(){var AQ;AQ=1<=arguments.length?m.call(arguments,0):[];if(b(AQ[0])){AQ=AQ[0]}return B.apply(null,[AE,"zipAsArray"].concat(m.call(AQ),[AE.zipWith(AQ,function(){var AR;AR=1<=arguments.length?m.call(arguments,0):[];return AR})]))};AE.zipWith=function(){var AR,AS,AQ;AR=arguments[0],AS=2<=arguments.length?m.call(arguments,1):[];if(!W(AR)){AQ=[AR,AS[0]],AS=AQ[0],AR=AQ[1]}AS=AP.map((function(AT){return AT.toEventStream()}),AS);return B.apply(null,[AE,"zipWith",AR].concat(m.call(AS),[AE.when(AS,AR)]))};AE.groupSimultaneous=function(){var AR,AQ,AS;AS=1<=arguments.length?m.call(arguments,0):[];if(AS.length===1&&b(AS[0])){AS=AS[0]}AQ=(function(){var AV,AU,AT;AT=[];for(AV=0,AU=AS.length;AV<AU;AV++){AR=AS[AV];AT.push(new a(AR))}return AT})();return B.apply(null,[AE,"groupSimultaneous"].concat(m.call(AS),[AE.when(AQ,(function(){var AT;AT=1<=arguments.length?m.call(arguments,0):[];return AT}))]))};AE.combineAsArray=function(){var AS,AT,AR,AV,AW,AU,AQ;AW=1<=arguments.length?m.call(arguments,0):[];if(AW.length===1&&b(AW[0])){AW=AW[0]}for(AS=AU=0,AQ=AW.length;AU<AQ;AS=++AU){AV=AW[AS];if(!(AF(AV))){AW[AS]=AE.constant(AV)}}if(AW.length){AR=(function(){var AZ,AY,AX;AX=[];for(AZ=0,AY=AW.length;AZ<AY;AZ++){AT=AW[AZ];AX.push(new AG(AT,true,false,AT.subscribeInternal))}return AX})();return B.apply(null,[AE,"combineAsArray"].concat(m.call(AW),[AE.when(AR,(function(){var AX;AX=1<=arguments.length?m.call(arguments,0):[];return AX})).toProperty()]))}else{return AE.constant([])}};AE.onValues=function(){var AR,AS,AQ;AS=2<=arguments.length?m.call(arguments,0,AQ=arguments.length-1):(AQ=0,[]),AR=arguments[AQ++];return AE.combineAsArray(AS).onValues(AR)};AE.combineWith=function(){var AQ,AR;AQ=arguments[0],AR=2<=arguments.length?m.call(arguments,1):[];return B.apply(null,[AE,"combineWith",AQ].concat(m.call(AR),[AE.combineAsArray(AR).map(function(AS){return AQ.apply(null,AS)})]))};AE.combineTemplate=function(AX){var AS,AT,AZ,AY,AR,AV,AQ,AW,AU,Aa;AQ=[];Aa=[];AV=function(Ab){return Ab[Ab.length-1]};AU=function(Ab,Ac,Ad){return AV(Ab)[Ac]=Ad};AS=function(Ac,Ab){return function(Ae,Ad){return AU(Ae,Ac,Ad[Ab])}};AR=function(Ab,Ac){return function(Ad){return AU(Ad,Ab,Ac)}};AW=function(Ab){if(b(Ab)){return[]}else{return{}}};AZ=function(Ac,Ad){var Ae,Ab;if(AF(Ad)){Aa.push(Ad);return AQ.push(AS(Ac,Aa.length-1))}else{if(Ad===Object(Ad)&&typeof Ad!=="function"){Ab=function(Af){return function(Ag){var Ah;Ah=AW(Ad);AU(Ag,Af,Ah);return Ag.push(Ah)}};Ae=function(Af){return Af.pop()};AQ.push(Ab(Ac));AY(Ad);return AQ.push(Ae)}else{return AQ.push(AR(Ac,Ad))}}};AY=function(Ab){return AP.each(Ab,AZ)};AY(AX);AT=function(Ae){var Ad,Ag,Ab,Af,Ac;Ab=AW(AX);Ad=[Ab];for(Af=0,Ac=AQ.length;Af<Ac;Af++){Ag=AQ[Af];Ag(Ad,Ae)}return Ab};return B(AE,"combineTemplate",AX,AE.combineAsArray(Aa).map(AT))};x=0;t=(function(){function AQ(){this.id=++x}AQ.prototype.isEvent=function(){return true};AQ.prototype.isEnd=function(){return false};AQ.prototype.isInitial=function(){return false};AQ.prototype.isNext=function(){return false};AQ.prototype.isError=function(){return false};AQ.prototype.hasValue=function(){return false};AQ.prototype.filter=function(){return true};AQ.prototype.inspect=function(){return this.toString()};return AQ})();AJ=(function(AR){L(AQ,AR);function AQ(AS){AQ.__super__.constructor.call(this);if(W(AS)){this.value=AP.cached(AS)}else{this.value=AP.always(AS)}}AQ.prototype.isNext=function(){return true};AQ.prototype.hasValue=function(){return true};AQ.prototype.fmap=function(AS){var AT=this;return this.apply(function(){return AS(AT.value())})};AQ.prototype.apply=function(AS){return new AQ(AS)};AQ.prototype.filter=function(AS){return AS(this.value())};AQ.prototype.toString=function(){return AP.toString(this.value())};return AQ})(t);AC=(function(AR){L(AQ,AR);function AQ(){R=AQ.__super__.constructor.apply(this,arguments);return R}AQ.prototype.isInitial=function(){return true};AQ.prototype.isNext=function(){return false};AQ.prototype.apply=function(AS){return new AQ(AS)};AQ.prototype.toNext=function(){return new AJ(this.value)};return AQ})(AJ);E=(function(AQ){L(AR,AQ);function AR(){P=AR.__super__.constructor.apply(this,arguments);return P}AR.prototype.isEnd=function(){return true};AR.prototype.fmap=function(){return this};AR.prototype.apply=function(){return this};AR.prototype.toString=function(){return"<end>"};return AR})(t);Q=(function(AQ){L(AR,AQ);function AR(AS){this.error=AS}AR.prototype.isError=function(){return true};AR.prototype.fmap=function(){return this};AR.prototype.apply=function(){return this};AR.prototype.toString=function(){return"<error> "+AP.toString(this.error)};return AR})(t);k=0;G=(function(){function AQ(AR){this.combine=H(this.combine,this);this.flatMapLatest=H(this.flatMapLatest,this);this.fold=H(this.fold,this);this.scan=H(this.scan,this);this.id=++k;this.assign=this.onValue;B(AR,this)}AQ.prototype.onValue=function(){var AR;AR=AH(arguments);return this.subscribe(function(AS){if(AS.hasValue()){return AR(AS.value())}})};AQ.prototype.onValues=function(AR){return this.onValue(function(AS){return AR.apply(null,AS)})};AQ.prototype.onError=function(){var AR;AR=AH(arguments);return this.subscribe(function(AS){if(AS.isError()){return AR(AS.error)}})};AQ.prototype.onEnd=function(){var AR;AR=AH(arguments);return this.subscribe(function(AS){if(AS.isEnd()){return AR()}})};AQ.prototype.errors=function(){return B(this,"errors",this.filter(function(){return false}))};AQ.prototype.filter=function(){var AR,AS;AS=arguments[0],AR=2<=arguments.length?m.call(arguments,1):[];return s(this,AS,AR,function(AT){return B(this,"filter",AT,this.withHandler(function(AU){if(AU.filter(AT)){return this.push(AU)}else{return AE.more}}))})};AQ.prototype.takeWhile=function(){var AR,AS;AS=arguments[0],AR=2<=arguments.length?m.call(arguments,1):[];return s(this,AS,AR,function(AT){return B(this,"takeWhile",AT,this.withHandler(function(AU){if(AU.filter(AT)){return this.push(AU)}else{this.push(Y());return AE.noMore}}))})};AQ.prototype.endOnError=function(){var AR,AS;AS=arguments[0],AR=2<=arguments.length?m.call(arguments,1):[];if(AS==null){AS=true}return s(this,AS,AR,function(AT){return B(this,"endOnError",this.withHandler(function(AU){if(AU.isError()&&AT(AU.error)){this.push(AU);return this.push(Y())}else{return this.push(AU)}}))})};AQ.prototype.take=function(AR){if(AR<=0){return AE.never()}return B(this,"take",AR,this.withHandler(function(AS){if(!AS.hasValue()){return this.push(AS)}else{AR--;if(AR>0){return this.push(AS)}else{if(AR===0){this.push(AS)}this.push(Y());return AE.noMore}}}))};AQ.prototype.map=function(){var AR,AS;AS=arguments[0],AR=2<=arguments.length?m.call(arguments,1):[];if(AS instanceof S){return AS.sampledBy(this,O)}else{return s(this,AS,AR,function(AT){return B(this,"map",AT,this.withHandler(function(AU){return this.push(AU.fmap(AT))}))})}};AQ.prototype.mapError=function(){var AR;AR=AH(arguments);return B(this,"mapError",AR,this.withHandler(function(AS){if(AS.isError()){return this.push(F(AR(AS.error)))}else{return this.push(AS)}}))};AQ.prototype.mapEnd=function(){var AR;AR=AH(arguments);return B(this,"mapEnd",AR,this.withHandler(function(AS){if(AS.isEnd()){this.push(F(AR(AS)));this.push(Y());return AE.noMore}else{return this.push(AS)}}))};AQ.prototype.doAction=function(){var AR;AR=AH(arguments);return B(this,"doAction",AR,this.withHandler(function(AS){if(AS.hasValue()){AR(AS.value())}return this.push(AS)}))};AQ.prototype.skip=function(AR){return B(this,"skip",AR,this.withHandler(function(AS){if(!AS.hasValue()){return this.push(AS)}else{if(AR>0){AR--;return AE.more}else{return this.push(AS)}}}))};AQ.prototype.skipDuplicates=function(AR){if(AR==null){AR=function(AT,AS){return AT===AS}}return B(this,"skipDuplicates",this.withStateMachine(K,function(AT,AS){if(!AS.hasValue()){return[AT,[AS]]}else{if(AS.isInitial()||AT===K||!AR(AT.get(),AS.value())){return[new l(AS.value()),[AS]]}else{return[AT,[]]}}}))};AQ.prototype.skipErrors=function(){return B(this,"skipErrors",this.withHandler(function(AR){if(AR.isError()){return AE.more}else{return this.push(AR)}}))};AQ.prototype.withStateMachine=function(AR,AT){var AS;AS=AR;return B(this,"withStateMachine",AR,AT,this.withHandler(function(AY){var AX,Aa,AV,Ab,AW,AZ,AU;AX=AT(AS,AY);Aa=AX[0],Ab=AX[1];AS=Aa;AW=AE.more;for(AZ=0,AU=Ab.length;AZ<AU;AZ++){AV=Ab[AZ];AW=this.push(AV);if(AW===AE.noMore){return AW}}return AW}))};AQ.prototype.scan=function(AV,AX,AY){var AT,AU,AS,AZ,AR,AW=this;AU=AN(AX);AX=AY?AU:function(Aa,Ab){return AU(Aa(),Ab())};AT=h(AV).map(function(Aa){return AP.always(Aa)});AZ=this;AR=function(Ae){var Ad,Ac,Ab,Aa;Ad=false;Aa=y;Ac=AE.more;Ab=function(){if(!Ad){return AT.forEach(function(Af){Ad=true;Ac=Ae(new AC(Af));if(Ac===AE.noMore){Aa();return Aa=y}})}};Aa=AW.subscribe(function(Ah){var Af,Ag;if(Ah.hasValue()){if(Ad&&Ah.isInitial()){return AE.more}else{if(!Ah.isInitial()){Ab()}Ad=true;Ag=AT.getOrElse(function(){return void 0});Af=AP.cached(function(){return AX(Ag,Ah.value)});AT=new l(Af);return Ae(Ah.apply(Af))}}else{if(Ah.isEnd()){Ac=Ab()}if(Ac!==AE.noMore){return Ae(Ah)}}});i.whenDone(AS,Ab);return Aa};return AS=new S(AI(this,"scan",AV,AX),AR)};AQ.prototype.fold=function(AR,AS){return B(this,"fold",AR,AS,this.scan(AR,AS).sampledBy(this.filter(false).mapEnd().toProperty()))};AQ.prototype.zip=function(AR,AS){if(AS==null){AS=Array}return B(this,"zip",AR,AE.zipWith([this,AR],AS))};AQ.prototype.diff=function(AS,AR){AR=AN(AR);return B(this,"diff",AS,AR,this.scan([AS],function(AT,AU){return[AU,AR(AT[0],AU)]}).filter(function(AT){return AT.length===2}).map(function(AT){return AT[1]}))};AQ.prototype.flatMap=function(AT,AS){var AR;AT=o(AT);AR=this;return new AK(AI(AR,"flatMap"+(AS?"First":""),AT),function(AU){var AV,AW;AW=new I();AV=function(AX){AX();if(AW.empty()){return AU(Y())}};AW.add(function(AY,AX){return AR.subscribe(function(AZ){var Aa;if(AZ.isEnd()){return AV(AX)}else{if(AZ.isError()){return AU(AZ)}else{if(AS&&AW.count()>1){return AE.more}else{if(AW.unsubscribed){return AE.noMore}Aa=AT(AZ.value());if(!(AF(Aa))){Aa=AE.once(Aa)}return AW.add(function(Ac,Ab){return Aa.subscribe(function(Ae){var Ad;if(Ae.isEnd()){AV(Ab);return AE.noMore}else{if(Ae instanceof AC){Ae=Ae.toNext()}Ad=AU(Ae);if(Ad===AE.noMore){Ac()}return Ad}})})}}}})});return AW.unsubscribe})};AQ.prototype.flatMapFirst=function(AR){return this.flatMap(AR,true)};AQ.prototype.flatMapLatest=function(AR){var AS,AT=this;AR=o(AR);AS=this.toEventStream();return B(this,"flatMapLatest",AR,AS.flatMap(function(AU){return AR(AU).takeUntil(AS)}))};AQ.prototype.not=function(){return B(this,"not",this.map(function(AR){return !AR}))};AQ.prototype.log=function(){var AR;AR=1<=arguments.length?m.call(arguments,0):[];this.subscribe(function(AS){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log.apply(console,m.call(AR).concat([AS.toString()])):void 0:void 0});return this};AQ.prototype.slidingWindow=function(AS,AR){if(AR==null){AR=0}return B(this,"slidingWindow",AS,AR,this.scan([],(function(AT,AU){return AT.concat([AU]).slice(-AS)})).filter((function(AT){return AT.length>=AR})))};AQ.prototype.combine=function(AR,AT){var AS;AS=AN(AT);return B(this,"combine",AR,AT,AE.combineAsArray(this,AR).map(function(AU){return AS(AU[0],AU[1])}))};AQ.prototype.decode=function(AR){return B(this,"decode",AR,this.combine(AE.combineTemplate(AR),function(AT,AS){return AS[AT]}))};AQ.prototype.awaiting=function(AR){return B(this,"awaiting",AR,AE.groupSimultaneous(this,AR).map(function(AS){var AT,AU;AT=AS[0],AU=AS[1];return AU.length===0}).toProperty(false).skipDuplicates())};AQ.prototype.name=function(AR){this.toString=function(){return AR};return this};return AQ})();G.prototype.reduce=G.prototype.fold;AK=(function(AR){L(AQ,AR);function AQ(AU,AS){this.takeUntil=H(this.takeUntil,this);this.sampledBy=H(this.sampledBy,this);var AT;if(W(AU)){AS=AU;AU=[]}AQ.__super__.constructor.call(this,AU);D(AS);AT=new AD(AS);this.subscribe=AT.subscribe;this.subscribeInternal=this.subscribe;this.hasSubscribers=AT.hasSubscribers;w(this)}AQ.prototype.delay=function(AS){return B(this,"delay",AS,this.flatMap(function(AT){return AE.later(AS,AT)}))};AQ.prototype.debounce=function(AS){return B(this,"debounce",AS,this.flatMapLatest(function(AT){return AE.later(AS,AT)}))};AQ.prototype.debounceImmediate=function(AS){return B(this,"debounceImmediate",AS,this.flatMapFirst(function(AT){return AE.once(AT).concat(AE.later(AS).filter(false))}))};AQ.prototype.throttle=function(AS){return B(this,"throttle",AS,this.bufferWithTime(AS).map(function(AT){return AT[AT.length-1]}))};AQ.prototype.bufferWithTime=function(AS){return B(this,"bufferWithTime",AS,this.bufferWithTimeOrCount(AS,Number.MAX_VALUE))};AQ.prototype.bufferWithCount=function(AS){return B(this,"bufferWithCount",AS,this.bufferWithTimeOrCount(void 0,AS))};AQ.prototype.bufferWithTimeOrCount=function(AS,AT){var AU;AU=function(AV){if(AV.values.length===AT){return AV.flush()}else{if(AS!==void 0){return AV.schedule()}}};return B(this,"bufferWithTimeOrCount",AS,AT,this.buffer(AS,AU,AU))};AQ.prototype.buffer=function(AU,AW,AT){var AS,AX,AV;if(AW==null){AW=(function(){})}if(AT==null){AT=(function(){})}AS={scheduled:false,end:null,values:[],flush:function(){var AY;this.scheduled=false;if(this.values.length>0){AY=this.push(F(this.values));this.values=[];if(this.end!=null){return this.push(this.end)}else{if(AY!==AE.noMore){return AT(this)}}}else{if(this.end!=null){return this.push(this.end)}}},schedule:function(){var AY=this;if(!this.scheduled){this.scheduled=true;return AU(function(){return AY.flush()})}}};AV=AE.more;if(!W(AU)){AX=AU;AU=function(AY){return AE.scheduler.setTimeout(AY,AX)}}return B(this,"buffer",this.withHandler(function(AY){AS.push=this.push;if(AY.isError()){AV=this.push(AY)}else{if(AY.isEnd()){AS.end=AY;if(!AS.scheduled){AS.flush()}}else{AS.values.push(AY.value());AW(AS)}}return AV}))};AQ.prototype.merge=function(AS){var AT;U(AS);AT=this;return new AQ(AI(AT,"merge",AS),function(AW){var AU,AV;AU=0;AV=function(AX){return function(AY){return AX.subscribe(function(Aa){var AZ;if(Aa.isEnd()){AU++;if(AU===2){return AW(Y())}else{return AE.more}}else{AZ=AW(Aa);if(AZ===AE.noMore){AY()}return AZ}})}};return n(AV(AT),AV(AS))})};AQ.prototype.toProperty=function(AS){if(arguments.length===0){AS=K}return B(this,"toProperty",AS,this.scan(AS,g,true))};AQ.prototype.toEventStream=function(){return this};AQ.prototype.sampledBy=function(AS,AT){return B(this,"sampledBy",AS,AT,this.toProperty().sampledBy(AS,AT))};AQ.prototype.concat=function(AS){var AT;AT=this;return new AQ(AI(AT,"concat",AS),function(AV){var AW,AU;AU=y;AW=AT.subscribe(function(AX){if(AX.isEnd()){return AU=AS.subscribe(AV)}else{return AV(AX)}});return function(){AW();return AU()}})};AQ.prototype.takeUntil=function(AS){var AT;AT={};return B(this,"takeUntil",AS,AE.groupSimultaneous(this.mapEnd(AT),AS.skipErrors()).withHandler(function(AW){var AZ,AV,AY,AX,AU,Aa;if(!AW.hasValue()){return this.push(AW)}else{Aa=AW.value(),AZ=Aa[0],AS=Aa[1];if(AS.length){return this.push(Y())}else{AV=AE.more;for(AX=0,AU=AZ.length;AX<AU;AX++){AY=AZ[AX];if(AY===AT){AV=this.push(Y())}else{AV=this.push(F(AY))}}return AV}}}))};AQ.prototype.skipUntil=function(AT){var AS;AS=AT.take(1).map(true).toProperty(false);return B(this,"skipUntil",AT,this.filter(AS))};AQ.prototype.skipWhile=function(){var AS,AU,AT;AU=arguments[0],AS=2<=arguments.length?m.call(arguments,1):[];AT=false;return s(this,AU,AS,function(AV){return B(this,"skipWhile",AV,this.withHandler(function(AW){if(AT||!AW.hasValue()||!AV(AW.value())){if(AW.hasValue()){AT=true}return this.push(AW)}else{return AE.more}}))})};AQ.prototype.startWith=function(AS){return B(this,"startWith",AS,AE.once(AS).concat(this))};AQ.prototype.withHandler=function(AT){var AS;AS=new AD(this.subscribe,AT);return new AQ(AI(this,"withHandler",AT),AS.subscribe)};return AQ})(G);S=(function(AQ){L(AR,AQ);function AR(AU,AS,AT){this.toEventStream=H(this.toEventStream,this);this.toProperty=H(this.toProperty,this);this.changes=H(this.changes,this);this.sample=H(this.sample,this);var AV=this;if(W(AU)){AT=AS;AS=AU;AU=[]}AR.__super__.constructor.call(this,AU);D(AS);if(AT===true){this.subscribeInternal=AS}else{this.subscribeInternal=new AB(this,AS,AT).subscribe}this.sampledBy=function(AY,Ab){var AX,AW,AZ,Ac,Aa;if(Ab!=null){Ab=AN(Ab)}else{AX=true;Ab=function(Ad){return Ad()}}Aa=new AG(AV,false,false,AV.subscribeInternal,AX);AZ=new AG(AY,true,false,AY.subscribe,AX);Ac=AE.when([Aa,AZ],Ab);AW=AY instanceof AR?Ac.toProperty():Ac;return B(AV,"sampledBy",AY,Ab,AW)};this.subscribe=this.subscribeInternal;w(this)}AR.prototype.sample=function(AS){return B(this,"sample",AS,this.sampledBy(AE.interval(AS,{})))};AR.prototype.changes=function(){var AS=this;return new AK(AI(this,"changes"),function(AT){return AS.subscribe(function(AU){if(!AU.isInitial()){return AT(AU)}})})};AR.prototype.withHandler=function(AS){return new AR(AI(this,"withHandler",AS),this.subscribeInternal,AS)};AR.prototype.toProperty=function(){j(arguments);return this};AR.prototype.toEventStream=function(){var AS=this;return new AK(AI(this,"toEventStream"),function(AT){return AS.subscribe(function(AU){if(AU.isInitial()){AU=AU.toNext()}return AT(AU)})})};AR.prototype.and=function(AS){return B(this,"and",AS,this.combine(AS,function(AT,AU){return AT&&AU}))};AR.prototype.or=function(AS){return B(this,"or",AS,this.combine(AS,function(AT,AU){return AT||AU}))};AR.prototype.delay=function(AS){return this.delayChanges("delay",AS,function(AT){return AT.delay(AS)})};AR.prototype.debounce=function(AS){return this.delayChanges("debounce",AS,function(AT){return AT.debounce(AS)})};AR.prototype.throttle=function(AS){return this.delayChanges("throttle",AS,function(AT){return AT.throttle(AS)})};AR.prototype.delayChanges=function(){var AU,AT,AS;AU=2<=arguments.length?m.call(arguments,0,AS=arguments.length-1):(AS=0,[]),AT=arguments[AS++];return B.apply(null,[this].concat(m.call(AU),[A(this,AT(this.changes()))]))};AR.prototype.takeUntil=function(AT){var AS;AS=this.changes().takeUntil(AT);return B(this,"takeUntil",AT,A(this,AS))};AR.prototype.startWith=function(AS){return B(this,"startWith",AS,this.scan(AS,function(AU,AT){return AT}))};return AR})(G);s=function(AU,AS,AQ,AT){var AR;if(AS instanceof S){AR=AS.sampledBy(AU,function(AW,AV){return[AW,AV]});return AT.apply(AR,[function(AV){var AX,AW;AX=AV[0],AW=AV[1];return AX}]).map(function(AV){var AX,AW;AX=AV[0],AW=AV[1];return AW})}else{AS=z(AS,AQ);return AT.apply(AU,[AS])}};A=function(AR,AS){var AQ;AQ=new AK(AI(AR,"justInitValue"),function(AV){var AT,AU;AU=null;AT=AR.subscribe(function(AW){if(AW.hasValue()){AU=AW}return AE.noMore});i.whenDone(AQ,function(){if(AU!=null){AV(AU)}return AV(Y())});return AT});return AQ.concat(AS).toProperty()};AD=(function(){function AQ(AU,Ab){var AW,Ac,AX,AV,AY,AZ,Ad,AR,AT,AS,Aa=this;if(AU==null){AU=function(){return y}}AR=[];AZ=null;AY=false;Ac=false;this.hasSubscribers=function(){return AR.length>0};AX=null;AT=y;Ad=function(Ae){return AR=AP.without(Ae,AR)};AS=null;AW=function(){var Ah,Ag,Ai,Af,Ae;if(AS!=null){Ag=AS;AS=null;Ae=[];for(Ai=0,Af=Ag.length;Ai<Af;Ai++){Ah=Ag[Ai];Ae.push(Ah())}return Ae}};AV=function(Ai){var Ah,Ag,Ak,Af,Aj,Ae;if(!AY){if(Ai===AX){return }if(Ai.isError()){AX=Ai}Ak=false;try{AY=true;Af=AR;for(Aj=0,Ae=Af.length;Aj<Ae;Aj++){Ag=Af[Aj];Ah=Ag.sink(Ai);if(Ah===AE.noMore||Ai.isEnd()){Ad(Ag)}}Ak=true}finally{AY=false;if(!Ak){AZ=null}}Ak=true;while(AZ!=null?AZ.length:void 0){Ai=AP.head(AZ);AZ=AP.tail(AZ);this.push(Ai)}AW(Ai);if(this.hasSubscribers()){return AE.more}else{return AE.noMore}}else{AZ=(AZ||[]).concat([Ai]);return AE.more}};this.push=function(Ae){return i.inTransaction(Ae,Aa,AV,[Ae])};if(Ab==null){Ab=function(Ae){return this.push(Ae)}}this.handleEvent=function(Ae){if(Ae.isEnd()){Ac=true}return Ab.apply(Aa,[Ae])};this.subscribe=function(Af){var Ae;if(Ac){Af(Y());return y}else{D(Af);Ae={sink:Af};AR=AR.concat(Ae);if(AR.length===1){AT=AU(Aa.handleEvent)}D(AT);return function(){Ad(Ae);if(!Aa.hasSubscribers()){return AT()}}}}}return AQ})();AB=(function(AQ){L(AR,AQ);function AR(AX,AS,AU){var AW,AT,AZ,AV,AY=this;AR.__super__.constructor.call(this,AS,AU);AW=K;AT=void 0;AV=this.push;AS=this.subscribe;AZ=false;this.push=function(Aa){if(Aa.isEnd()){AZ=true}if(Aa.hasValue()){AW=new l(Aa);AT=i.currentEventId()}return AV.apply(AY,[Aa])};this.subscribe=function(Ad){var Af,Ac,Ab,Aa,Ae;Ac=false;Aa=AE.more;Ab=function(){if(Aa===AE.noMore){return y}else{if(AZ){Ad(Y());return y}else{return AS.apply(this,[Ad])}}};if(AW.isDefined&&(AY.hasSubscribers()||AZ)){Af=i.currentEventId();Ae=AT;if(!AZ&&Ae&&Af&&Af!==Ae){i.whenDone(AX,function(){if(AT===Ae){return Ad(AL(AW.get().value()))}});return Ab()}else{i.inTransaction(void 0,AY,(function(){return Aa=Ad(AL(AW.get().value()))}),[]);return Ab()}}else{return Ab()}}}return AR})(AD);AM=(function(AQ){L(AR,AQ);function AR(){var AY,AU,AZ,AW,AT,AS,Aa,AX,AV=this;AZ=void 0;AS=[];AY=false;AU=function(Ab){return function(Ac){if(Ac.isEnd()){AX(Ab);return AE.noMore}else{return AZ(Ac)}}};Aa=function(){var Ad,Ae,Ac,Ab;Ab=[];for(Ae=0,Ac=AS.length;Ae<Ac;Ae++){Ad=AS[Ae];Ab.push(typeof Ad.unsub==="function"?Ad.unsub():void 0)}return Ab};AT=function(Ab){return Ab.unsub=Ab.input.subscribe(AU(Ab.input))};AX=function(Ac){var Ad,Ae,Af,Ab;for(Ad=Af=0,Ab=AS.length;Af<Ab;Ad=++Af){Ae=AS[Ad];if(Ae.input===Ac){if(typeof Ae.unsub==="function"){Ae.unsub()}AS.splice(Ad,1);return }}};AW=function(Ac){var Ad,Ae,Ab,Af;AZ=Ac;Af=e(AS);for(Ae=0,Ab=Af.length;Ae<Ab;Ae++){Ad=Af[Ae];AT(Ad)}return Aa};AR.__super__.constructor.call(this,AI(AE,"Bus"),AW);this.plug=function(Ab){var Ac;if(AY){return }Ac={input:Ab};AS.push(Ac);if((AZ!=null)){AT(Ac)}return function(){return AX(Ab)}};this.push=function(Ab){return typeof AZ==="function"?AZ(F(Ab)):void 0};this.error=function(Ab){return typeof AZ==="function"?AZ(new Q(Ab)):void 0};this.end=function(){AY=true;Aa();return typeof AZ==="function"?AZ(Y()):void 0}}return AR})(AK);AG=(function(){function AQ(AX,AW,AT,AS,AV,AR){var AU;this.obs=AX;this.sync=AW;this.subscribe=AS;if(AV==null){AV=false}if(AR==null){AR=[]}AU=AV?AP.id:function(AY){return AY()};if(this.subscribe==null){this.subscribe=AX.subscribe}this.markEnded=function(){return this.ended=true};this.toString=this.obs.toString;if(AT){this.consume=function(){return AU(AR.shift())};this.push=function(AY){return AR.push(AY)};this.mayHave=function(AY){return !this.ended||AR.length>=AY};this.hasAtLeast=function(AY){return AR.length>=AY};this.flatten=false}else{this.consume=function(){return AU(AR[0])};this.push=function(AY){return AR=[AY]};this.mayHave=function(){return true};this.hasAtLeast=function(){return AR.length};this.flatten=true}}return AQ})();a=(function(AQ){L(AR,AQ);function AR(AT){var AS;this.obs=AT;AS=[];AR.__super__.constructor.call(this,this.obs,true,false,this.obs.subscribe,false,AS);this.consume=function(){var AU;AU=AS;AS=[];return AU};this.push=function(AU){return AS.push(AU())};this.hasAtLeast=function(){return true}}return AR})(AG);AG.fromObservable=function(AQ){if(AQ instanceof AG){return AQ}else{if(AQ instanceof S){return new AG(AQ,false,false)}else{return new AG(AQ,true,true)}}};AI=function(){var AQ,AR,AS;AR=arguments[0],AS=arguments[1],AQ=3<=arguments.length?m.call(arguments,2):[];if((AR||AS) instanceof p){return AR||AS}else{return new p(AR,AS,AQ)}};p=(function(){function AQ(AU,AX,AS){var AV,AR,AW,AT;AW=function(AY){if(b(AY)){return AP.flatMap(AW,AY)}else{if(AF(AY)){return[AY]}else{if(AY instanceof AG){return[AY.obs]}else{return[]}}}};AT=null;AV=function(AZ){var AY;AY=AZ.internalDeps();return AP.each(AY,function(Aa,Ab){AT[Ab.id]=true;return AV(Ab)})};AR=function(AY){if(AT==null){AT={};AV(this)}return AT[AY.id]};this.apply=function(AZ){var AY;AY=AP.cached((function(){return AW([AU].concat(AS))}));AZ.internalDeps=AZ.internalDeps||AY;AZ.dependsOn=AR;AZ.deps=AY;AZ.toString=function(){return AP.toString(AU)+"."+AP.toString(AX)+"("+AP.map(AP.toString,AS)+")"};AZ.inspect=function(){return AZ.toString()};AZ.desc=function(){return{context:AU,method:AX,args:AS}};return AZ}}return AQ})();B=function(){var AR,AS,AQ;AR=2<=arguments.length?m.call(arguments,0,AQ=arguments.length-1):(AQ=0,[]),AS=arguments[AQ++];return AI.apply(null,AR).apply(AS)};AE.when=function(){var Ae,Ac,AX,AW,Ad,AV,Aa,AZ,AY,AU,Ah,Ab,AQ,Af,AT,AR,Ag,Ai,AS;AU=1<=arguments.length?m.call(arguments,0):[];if(AU.length===0){return AE.never()}Ad=AU.length;Af="when: expecting arguments in the form (Observable+,function)+";q(Af,Ad%2===0);AQ=[];AY=[];Ac=0;while(Ac<Ad){AZ=AP.toArray(AU[Ac]);Ae=AU[Ac+1];Aa={f:(W(Ae)?Ae:(function(){return Ae})),ixs:[]};for(AT=0,Ag=AZ.length;AT<Ag;AT++){Ab=AZ[AT];q(AF(Ab),Af);AX=AP.indexOf(AQ,Ab);if(AX<0){AQ.push(Ab);AX=AQ.length-1}AS=Aa.ixs;for(AR=0,Ai=AS.length;AR<Ai;AR++){AW=AS[AR];if(AW.index===AX){AW.count++}}Aa.ixs.push({index:AX,count:1})}if(AZ.length>0){AY.push(Aa)}Ac=Ac+2}if(!AQ.length){return AE.never()}AQ=AP.map(AG.fromObservable,AQ);AV=(AP.any(AQ,function(Aj){return Aj.flatten}))&&(Z(AP.map((function(Aj){return Aj.obs}),AQ)));return Ah=new AK(AI.apply(null,[AE,"when"].concat(m.call(AU))),function(Aq){var Ap,Ao,Aj,Al,An,Ak,Am;Am=[];Aj=false;Al=function(Au){var As,Ar,At;At=Au.ixs;for(As=0,Ar=At.length;As<Ar;As++){Ac=At[As];if(!AQ[Ac.index].hasAtLeast(Ac.count)){return false}}return true};Ao=function(Ar){return !Ar.sync||Ar.ended};Ap=function(Au){var As,Ar,At;At=Au.ixs;for(As=0,Ar=At.length;As<Ar;As++){Ac=At[As];if(!AQ[Ac.index].mayHave(Ac.count)){return true}}};An=function(Ar){return !Ar.source.flatten};Ak=function(Ar){return function(At){var As,Av,Au;Av=function(){return i.whenDone(Ah,As)};Au=function(){var A0,Az,Ax,A1,Ay,Aw;if(Am.length>0){Az=AE.more;Ax=Am.pop();for(Ay=0,Aw=AY.length;Ay<Aw;Ay++){A0=AY[Ay];if(Al(A0)){A1=function(){return A0.f.apply(A0,(function(){var A3,A5,A4,A2;A4=A0.ixs;A2=[];for(A3=0,A5=A4.length;A3<A5;A3++){Ac=A4[A3];A2.push(AQ[Ac.index].consume())}return A2})())};Az=Aq(Ax.e.apply(A1));if(Am.length&&AV){Am=AP.filter(An,Am)}if(Az===AE.noMore){return Az}else{return Au()}}}}else{return AE.more}};As=function(){var Aw;Aw=Au();if(Aj){Aj=false;if(AP.all(AQ,Ao)||AP.all(AY,Ap)){Aw=AE.noMore;Aq(Y())}}if(Aw===AE.noMore){At()}return Aw};return Ar.subscribe(function(Ax){var Aw;if(Ax.isEnd()){Aj=true;Ar.markEnded();Av()}else{if(Ax.isError()){Aw=Aq(Ax)}else{Ar.push(Ax.value);if(Ar.sync){Am.push({source:Ar,e:Ax});if(AV){Av()}else{As()}}}}if(Aw===AE.noMore){At()}return Aw||AE.more})}};return n.apply(null,(function(){var At,Ar,As;As=[];for(At=0,Ar=AQ.length;At<Ar;At++){Ab=AQ[At];As.push(Ak(Ab))}return As})())})};Z=function(AS,AR){var AQ;if(AR==null){AR=[]}AQ=function(AU){var AT;if(AE._.contains(AR,AU)){return true}else{AT=AU.internalDeps();if(AT.length){AR.push(AU);return AE._.any(AT,AQ)}else{AR.push(AU);return false}}};return AE._.any(AS,AQ)};AE.update=function(){var AS,AR,AQ,AT;AR=arguments[0],AT=2<=arguments.length?m.call(arguments,1):[];AQ=function(AU){return function(){var AV;AV=1<=arguments.length?m.call(arguments,0):[];return function(AW){return AU.apply(null,[AW].concat(AV))}}};AS=AT.length-1;while(AS>0){if(!(AT[AS] instanceof Function)){AT[AS]=(function(AU){return function(){return AU}})(AT[AS])}AT[AS]=AQ(AT[AS]);AS=AS-2}return B.apply(null,[AE,"update",AR].concat(m.call(AT),[AE.when.apply(AE,AT).scan(AR,(function(AU,AV){return AV(AU)}))]))};n=function(){var AQ;AQ=1<=arguments.length?m.call(arguments,0):[];return new I(AQ).unsubscribe};I=(function(){function AQ(AS){var AT,AU,AR;if(AS==null){AS=[]}this.empty=H(this.empty,this);this.count=H(this.count,this);this.unsubscribe=H(this.unsubscribe,this);this.add=H(this.add,this);this.unsubscribed=false;this.subscriptions=[];this.starting=[];for(AU=0,AR=AS.length;AU<AR;AU++){AT=AS[AU];this.add(AT)}}AQ.prototype.add=function(AT){var AV,AS,AR,AU=this;if(this.unsubscribed){return }AV=false;AS=y;this.starting.push(AT);AR=function(){if(AU.unsubscribed){return }AV=true;AU.remove(AS);return AP.remove(AT,AU.starting)};AS=AT(this.unsubscribe,AR);if(!(this.unsubscribed||AV)){this.subscriptions.push(AS)}AP.remove(AT,this.starting);return AS};AQ.prototype.remove=function(AR){if(this.unsubscribed){return }if((AP.remove(AR,this.subscriptions))!==void 0){return AR()}};AQ.prototype.unsubscribe=function(){var AS,AT,AR,AU;if(this.unsubscribed){return }this.unsubscribed=true;AU=this.subscriptions;for(AT=0,AR=AU.length;AT<AR;AT++){AS=AU[AT];AS()}this.subscriptions=[];return this.starting=[]};AQ.prototype.count=function(){if(this.unsubscribed){return 0}return this.subscriptions.length+this.starting.length};AQ.prototype.empty=function(){return this.count()===0};return AQ})();AE.CompositeUnsubscribe=I;l=(function(){function AQ(AR){this.value=AR}AQ.prototype.getOrElse=function(){return this.value};AQ.prototype.get=function(){return this.value};AQ.prototype.filter=function(AR){if(AR(this.value)){return new AQ(this.value)}else{return K}};AQ.prototype.map=function(AR){return new AQ(AR(this.value))};AQ.prototype.forEach=function(AR){return AR(this.value)};AQ.prototype.isDefined=true;AQ.prototype.toArray=function(){return[this.value]};AQ.prototype.inspect=function(){return"Some("+this.value+")"};AQ.prototype.toString=function(){return this.inspect()};return AQ})();K={getOrElse:function(AQ){return AQ},filter:function(){return K},map:function(){return K},forEach:function(){},isDefined:false,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}};i=(function(){var AV,AW,AR,AX,AU,AT,AQ,AS;AT=void 0;AQ=[];AU=function(AY){return !AP.any(AQ,(function(AZ){return AY.obs.dependsOn(AZ.obs)}))};AS=function(AZ,AY){if(AT){return AQ.push({obs:AZ,f:AY})}else{return AY()}};AW=function(){while(!AU(AQ[0])){AQ.push(AQ.splice(0,1)[0])}return AQ.splice(0,1)[0]};AR=function(){if(AQ.length){AW().f();return AR()}};AX=function(Ab,Aa,Ac,AZ){var AY;if(AT){return Ac.apply(Aa,AZ)}else{AT=Ab;try{AY=Ac.apply(Aa,AZ);AR()}finally{AT=void 0}return AY}};AV=function(){if(AT){return AT.id}else{return void 0}};return{whenDone:AS,inTransaction:AX,currentEventId:AV}})();AE.EventStream=AK;AE.Property=S;AE.Observable=G;AE.Bus=AM;AE.Initial=AC;AE.Next=AJ;AE.End=E;AE.Error=Q;y=function(){};g=function(AR,AQ){return AQ()};O=function(AQ,AR){return AQ};AL=function(AQ){return new AC(AP.always(AQ))};F=function(AQ){return new AJ(AP.always(AQ))};Y=function(){return new E()};T=function(AQ){if(AQ instanceof t){return AQ}else{return F(AQ)}};e=function(AQ){return AQ.slice(0)};q=function(AQ,AR){if(!AR){throw AQ}};U=function(AQ){if(!(AQ instanceof AK)){throw"not an EventStream : "+AQ}};D=function(AQ){return q("not a function : "+AQ,W(AQ))};W=function(AQ){return typeof AQ==="function"};b=function(AQ){return AQ instanceof Array};AF=function(AQ){return AQ instanceof G};J=function(AQ){if(!b(AQ)){throw"not an array : "+AQ}};j=function(AQ){return q("no arguments supported",AQ.length===0)};X=function(AQ){if(typeof AQ!=="string"){throw"not a string : "+AQ}};r=function(AR,AQ){return function(){var AS;AS=1<=arguments.length?m.call(arguments,0):[];return AR.apply(null,AQ.concat(AS))}};o=function(AQ){if(AF(AQ)){AQ=AP.always(AQ)}D(AQ);return AQ};AH=function(AQ){AQ=Array.prototype.slice.call(AQ);return V.apply(null,AQ)};V=C(function(){var AQ,AR;AR=arguments[0],AQ=2<=arguments.length?m.call(arguments,1):[];if(W(AR)){if(AQ.length){return r(AR,AQ)}else{return AR}}else{if(N(AR)){return d(AR,AQ)}else{return AP.always(AR)}}});z=function(AR,AQ){return V.apply(null,[AR].concat(m.call(AQ)))};N=function(AQ){return(typeof AQ==="string")&&AQ.length>1&&AQ.charAt(0)==="."};AE.isFieldKey=N;d=function(AS,AQ){var AR,AT;AT=AS.slice(1).split(".");AR=AP.map(c(AQ),AT);return function(AW){var AV,AU;for(AV=0,AU=AR.length;AV<AU;AV++){AS=AR[AV];AW=AS(AW)}return AW}};c=function(AQ){return function(AR){return function(AT){var AS;if(AT==null){return void 0}else{AS=AT[AR];if(W(AS)){return AS.apply(AT,AQ)}else{return AS}}}}};v=function(AQ){return AQ.slice(1)};AN=function(AR){var AQ;if(W(AR)){return AR}else{if(N(AR)){AQ=v(AR);return function(AT,AS){return AT[AQ](AS)}}else{return q("not a function or a field key: "+AR,false)}}};h=function(AQ){if(AQ instanceof l||AQ===K){return AQ}else{return new l(AQ)}};AP={indexOf:Array.prototype.indexOf?function(AR,AQ){return AR.indexOf(AQ)}:function(AS,AQ){var AT,AV,AU,AR;for(AT=AU=0,AR=AS.length;AU<AR;AT=++AU){AV=AS[AT];if(AQ===AV){return AT}}return -1},indexWhere:function(AR,AU){var AS,AV,AT,AQ;for(AS=AT=0,AQ=AR.length;AT<AQ;AS=++AT){AV=AR[AS];if(AU(AV)){return AS}}return -1},head:function(AQ){return AQ[0]},always:function(AQ){return function(){return AQ}},negate:function(AQ){return function(AR){return !AQ(AR)}},empty:function(AQ){return AQ.length===0},tail:function(AQ){return AQ.slice(1,AQ.length)},filter:function(AV,AT){var AS,AQ,AU,AR;AS=[];for(AU=0,AR=AT.length;AU<AR;AU++){AQ=AT[AU];if(AV(AQ)){AS.push(AQ)}}return AS},map:function(AV,AT){var AQ,AU,AS,AR;AR=[];for(AU=0,AS=AT.length;AU<AS;AU++){AQ=AT[AU];AR.push(AV(AQ))}return AR},each:function(AR,AU){var AS,AT,AQ;AQ=[];for(AS in AR){AT=AR[AS];AQ.push(AU(AS,AT))}return AQ},toArray:function(AQ){if(b(AQ)){return AQ}else{return[AQ]}},contains:function(AR,AQ){return AP.indexOf(AR,AQ)!==-1},id:function(AQ){return AQ},last:function(AQ){return AQ[AQ.length-1]},all:function(AS,AU){var AQ,AT,AR;if(AU==null){AU=AP.id}for(AT=0,AR=AS.length;AT<AR;AT++){AQ=AS[AT];if(!AU(AQ)){return false}}return true},any:function(AS,AU){var AQ,AT,AR;if(AU==null){AU=AP.id}for(AT=0,AR=AS.length;AT<AR;AT++){AQ=AS[AT];if(AU(AQ)){return true}}return false},without:function(AQ,AR){return AP.filter((function(AS){return AS!==AQ}),AR)},remove:function(AQ,AR){var AS;AS=AP.indexOf(AR,AQ);if(AS>=0){return AR.splice(AS,1)}},fold:function(AT,AS,AV){var AQ,AU,AR;for(AU=0,AR=AT.length;AU<AR;AU++){AQ=AT[AU];AS=AV(AS,AQ)}return AS},flatMap:function(AR,AQ){return AP.fold(AQ,[],(function(AT,AS){return AT.concat(AR(AS))}))},cached:function(AR){var AQ;AQ=K;return function(){if(AQ===K){AQ=AR();AR=null}return AQ}},toString:function(AS){var AQ,AR;try{M++;if(AS==null){return"undefined"}else{if(W(AS)){return"function"}else{if(b(AS)){if(M>5){return"[..]"}return"["+AP.map(AP.toString,AS).toString()+"]"}else{if(((AS!=null?AS.toString:void 0)!=null)&&AS.toString!==Object.prototype.toString){return AS.toString()}else{if(typeof AS==="object"){if(M>5){return"{..}"}return"{"+((function(){var AT;AT=[];for(AQ in AS){AR=AS[AQ];AT.push(AP.toString(AQ)+":"+AP.toString(AR))}return AT})())+"}"}else{return AS}}}}}}finally{M--}}};M=0;AE._=AP;AE.scheduler={setTimeout:function(AQ,AR){return setTimeout(AQ,AR)},setInterval:function(AR,AQ){return setInterval(AR,AQ)},clearInterval:function(AQ){return clearInterval(AQ)},now:function(){return new Date().getTime()}};if(typeof module!=="undefined"&&module!==null){module.exports=AE;AE.Bacon=AE}else{if((typeof define!=="undefined"&&define!==null)&&(define.amd!=null)){define([],function(){return AE})}this.Bacon=AE}}).call(this);