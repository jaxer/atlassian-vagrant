CodeMirror.defineMode("htmlembedded",function(C,E){var A=E.scriptStartRegex||/^<%/i,B=E.scriptEndRegex||/^%>/i;var H,F;function G(J,I){if(J.match(A,false)){I.token=D;return H.token(J,I.scriptState)}else{return F.token(J,I.htmlState)}}function D(J,I){if(J.match(B,false)){I.token=G;return F.token(J,I.htmlState)}else{return H.token(J,I.scriptState)}}return{startState:function(){H=H||CodeMirror.getMode(C,E.scriptingModeSpec);F=F||CodeMirror.getMode(C,"htmlmixed");return{token:E.startOpen?D:G,htmlState:CodeMirror.startState(F),scriptState:CodeMirror.startState(H)}},token:function(J,I){return I.token(J,I)},indent:function(J,I){if(J.token==G){return F.indent(J.htmlState,I)}else{if(H.indent){return H.indent(J.scriptState,I)}}},copyState:function(I){return{token:I.token,htmlState:CodeMirror.copyState(F,I.htmlState),scriptState:CodeMirror.copyState(H,I.scriptState)}},innerMode:function(I){if(I.token==D){return{state:I.scriptState,mode:H}}else{return{state:I.htmlState,mode:F}}}}},"htmlmixed");CodeMirror.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"});CodeMirror.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"});CodeMirror.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"});CodeMirror.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"});