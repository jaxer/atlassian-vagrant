CodeMirror.defineMode("vb",function(L,Y){var B="error";function P(f){return new RegExp("^(("+f.join(")|(")+"))\\b","i")}var O=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]");var S=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var A=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var I=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var b=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var H=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var U=["class","module","sub","enum","select","while","if","function","get","set","property","try"];var R=["else","elseif","case","catch"];var e=["next","loop"];var D=P(["and","or","not","xor","in"]);var X=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"];var V=["integer","string","double","decimal","boolean","short","char","float","single"];var J=P(X);var N=P(V);var K='"';var T=P(U);var a=P(R);var G=P(e);var Q=P(["end"]);var C=P(["do"]);var Z=null;function M(f,g){g.currentIndent++}function E(f,g){g.currentIndent--}function d(j,i){if(j.eatSpace()){return null}var h=j.peek();if(h==="'"){j.skipToEnd();return"comment"}if(j.match(/^((&H)|(&O))?[0-9\.a-f]/i,false)){var g=false;if(j.match(/^\d*\.\d+F?/i)){g=true}else{if(j.match(/^\d+\.\d*F?/)){g=true}else{if(j.match(/^\.\d+F?/)){g=true}}}if(g){j.eat(/J/i);return"number"}var f=false;if(j.match(/^&H[0-9a-f]+/i)){f=true}else{if(j.match(/^&O[0-7]+/i)){f=true}else{if(j.match(/^[1-9]\d*F?/)){j.eat(/J/i);f=true}else{if(j.match(/^0(?![\dx])/i)){f=true}}}}if(f){j.eat(/L/i);return"number"}}if(j.match(K)){i.tokenize=W(j.current());return i.tokenize(j,i)}if(j.match(b)||j.match(I)){return null}if(j.match(A)||j.match(O)||j.match(D)){return"operator"}if(j.match(S)){return null}if(j.match(C)){M(j,i);i.doInCurrentLine=true;return"keyword"}if(j.match(T)){if(!i.doInCurrentLine){M(j,i)}else{i.doInCurrentLine=false}return"keyword"}if(j.match(a)){return"keyword"}if(j.match(Q)){E(j,i);E(j,i);return"keyword"}if(j.match(G)){E(j,i);return"keyword"}if(j.match(N)){return"keyword"}if(j.match(J)){return"keyword"}if(j.match(H)){return"variable"}j.next();return B}function W(f){var h=f.length==1;var g="string";return function(j,i){while(!j.eol()){j.eatWhile(/[^'"]/);if(j.match(f)){i.tokenize=d;return g}else{j.eat(/['"]/)}}if(h){if(Y.singleLineStringErrors){return B}else{i.tokenize=d}}return g}}function c(j,h){var g=h.tokenize(j,h);var i=j.current();if(i==="."){g=h.tokenize(j,h);i=j.current();if(g==="variable"){return"variable"}else{return B}}var f="[({".indexOf(i);if(f!==-1){M(j,h)}if(Z==="dedent"){if(E(j,h)){return B}}f="])}".indexOf(i);if(f!==-1){if(E(j,h)){return B}}return g}var F={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:d,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false}},token:function(h,g){if(h.sol()){g.currentIndent+=g.nextLineIndent;g.nextLineIndent=0;g.doInCurrentLine=0}var f=c(h,g);g.lastToken={style:f,content:h.current()};return f},indent:function(h,f){var g=f.replace(/^\s+|\s+$/g,"");if(g.match(G)||g.match(Q)||g.match(a)){return L.indentUnit*(h.currentIndent-1)}if(h.currentIndent<0){return 0}return h.currentIndent*L.indentUnit}};return F});CodeMirror.defineMIME("text/x-vb","vb");