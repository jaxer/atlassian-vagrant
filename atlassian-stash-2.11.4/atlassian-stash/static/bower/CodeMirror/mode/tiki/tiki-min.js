CodeMirror.defineMode("tiki",function(U){function T(Y,X,W){return function(a,Z){while(!a.eol()){if(a.match(X)){Z.tokenize=M;break}a.next()}if(W){Z.tokenize=W}return Y}}function L(W){return function(Y,X){while(!Y.eol()){Y.next()}X.tokenize=M;return W}}function M(b,a){function X(c){a.tokenize=c;return c(b,a)}var Z=b.sol();var Y=b.next();switch(Y){case"{":b.eat("/");b.eatSpace();var W="";var d;while((d=b.eat(/[^\s\u00a0=\"\'\/?(}]/))){W+=d}a.tokenize=V;return"tag";break;case"_":if(b.eat("_")){return X(T("strong","__",M))}break;case"'":if(b.eat("'")){return X(T("em","''",M))}break;case"(":if(b.eat("(")){return X(T("variable-2","))",M))}break;case"[":return X(T("variable-3","]",M));break;case"|":if(b.eat("|")){return X(T("comment","||"))}break;case"-":if(b.eat("=")){return X(T("header string","=-",M))}else{if(b.eat("-")){return X(T("error tw-deleted","--",M))}}break;case"=":if(b.match("==")){return X(T("tw-underline","===",M))}break;case":":if(b.eat(":")){return X(T("comment","::"))}break;case"^":return X(T("tw-box","^"));break;case"~":if(b.match("np~")){return X(T("meta","~/np~"))}break}if(Z){switch(Y){case"!":if(b.match("!!!!!")){return X(L("header string"))}else{if(b.match("!!!!")){return X(L("header string"))}else{if(b.match("!!!")){return X(L("header string"))}else{if(b.match("!!")){return X(L("header string"))}else{return X(L("header string"))}}}}break;case"*":case"#":case"+":return X(L("tw-listitem bracket"));break}}return null}var N=U.indentUnit;var A,F;function V(Z,Y){var X=Z.next();var W=Z.peek();if(X=="}"){Y.tokenize=M;return"tag"}else{if(X=="("||X==")"){return"bracket"}else{if(X=="="){F="equals";if(W==">"){X=Z.next();W=Z.peek()}if(!/[\'\"]/.test(W)){Y.tokenize=R()}return"operator"}else{if(/[\'\"]/.test(X)){Y.tokenize=I(X);return Y.tokenize(Z,Y)}else{Z.eatWhile(/[^\s\u00a0=\"\'\/?]/);return"keyword"}}}}}function I(W){return function(Y,X){while(!Y.eol()){if(Y.next()==W){X.tokenize=V;break}}return"string"}}function R(){return function(Z,Y){while(!Z.eol()){var X=Z.next();var W=Z.peek();if(X==" "||X==","||/[ )}]/.test(W)){Y.tokenize=V;break}}return"string"}}var J,G;function B(){for(var W=arguments.length-1;W>=0;W--){J.cc.push(arguments[W])}}function D(){B.apply(null,arguments);return true}function H(X,Y){var W=J.context&&J.context.noIndent;J.context={prev:J.context,pluginName:X,indent:J.indented,startOfLine:Y,noIndent:W}}function Q(){if(J.context){J.context=J.context.prev}}function C(W){if(W=="openPlugin"){J.pluginName=A;return D(K,O(J.startOfLine))}else{if(W=="closePlugin"){var X=false;if(J.context){X=J.context.pluginName!=A;Q()}else{X=true}if(X){G="error"}return D(E(X))}else{if(W=="string"){if(!J.context||J.context.name!="!cdata"){H("!cdata")}if(J.tokenize==M){Q()}return D()}else{return D()}}}}function O(W){return function(X){if(X=="selfclosePlugin"||X=="endPlugin"){return D()}if(X=="endPlugin"){H(J.pluginName,W);return D()}return D()}}function E(W){return function(X){if(W){G="error"}if(X=="endPlugin"){return D()}return B()}}function K(W){if(W=="keyword"){G="attribute";return D(K)}if(W=="equals"){return D(S,K)}return B()}function S(W){if(W=="keyword"){G="string";return D()}if(W=="string"){return D(P)}return B()}function P(W){if(W=="string"){return D(P)}else{return B()}}return{startState:function(){return{tokenize:M,cc:[],indented:0,startOfLine:true,pluginName:null,context:null}},token:function(Z,Y){if(Z.sol()){Y.startOfLine=true;Y.indented=Z.indentation()}if(Z.eatSpace()){return null}G=F=A=null;var X=Y.tokenize(Z,Y);if((X||F)&&X!="comment"){J=Y;while(true){var W=Y.cc.pop()||C;if(W(F||X)){break}}}Y.startOfLine=false;return G||X},indent:function(Y,W){var X=Y.context;if(X&&X.noIndent){return 0}if(X&&/^{\//.test(W)){X=X.prev}while(X&&!X.startOfLine){X=X.prev}if(X){return X.indent+N}else{return 0}},electricChars:"/"}});CodeMirror.defineMIME("text/tiki","tiki");