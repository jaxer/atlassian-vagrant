define("page/maintenance/lock",["jquery","util/ajax","util/navbuilder","widget/submit-spinner","layout/maintenance","exports"],function(E,D,F,C,A,B){B.onReady=function(G){var H=AJS.contextPath()+"/mvc/maintenance/lock",J="cancel";var I={pollUrl:H,pollTickCallback:function(L,K,N,M){return undefined},cancelButtonId:J,redirectUrl:G?F.admin().build():F.allProjects().build(),canceledHeader:stash_i18n("stash.web.lock.canceled.title","Stash unlocked"),cancelingDescription:stash_i18n("stash.web.lock.canceling.description","Unlocking Stash."),hasCancelDialog:false};E("#"+J).on("click",function(N){var O=E(this),K=O.closest("form"),L=K.find("input[name=token]"),M=L.val(),P=new C(O,"after");P.show();D.rest({url:H+"?token="+encodeURIComponent(M),type:"DELETE",statusCode:{409:function(S,T,Q,R){L.parent().replaceWith(stash.layout.maintenance.tokenInputField(R));return false},"*":function(){return false}}}).always(function(){P.hide()}).done(function(){window.location=I.redirectUrl});N.preventDefault()});A.init(I)}});