define("page/project/permissions",["jquery","exports","util/navbuilder","widget/submit-spinner","feature/permission/permission-table","page/project/permissions/project-permissions-model"],function(E,B,F,D,A,C){B.onReady=function(L){var H=I("none");var G=E("#public-access-allowed");var N;var J;var M=new C({grantedDefaultPermission:E("#licensed-users-permissions").attr("data-granted-permission"),publicAccess:!!G.prop("checked")});function I(P){var O='input:radio[name="licensed-users-permissions"]';if(P){O+='[value="'+P+'"]'}return E(O)}M.on("change:grantedDefaultPermission",function(O){I(O.getGrantedDefaultPermission()).prop("checked",true)});M.on("change:publicAccess",function(O){I(O.getEffectiveDefaultPermission()).prop("checked",true);H.prop("disabled",O.getPublicAccess());G.prop("checked",O.getPublicAccess())});I().each(function(){var P;var O;E(this).click(function(){if(!P){P=new D(E(this).next("label"))}if(O){O.abort()}P.show();var Q=I().filter(":checked").val();O=M.saveDefaultPermission(Q);O.always(function(){P.hide();O=null})})});G.click(function(){if(!N){N=new D(E(this).next("label"))}if(J){J.abort()}N.show();J=M.savePublicAccess(this.checked);J.always(function(){N.hide();J=null})});H.next("label").tooltip({gravity:"sw",title:function(){return M.getPublicAccess()?H.parent().attr("data-disabled-title"):""}});var K=A.initialise(F.currentProject().permissions(),L,"PROJECT_ADMIN")}});