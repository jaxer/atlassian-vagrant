define("util/time",["moment","exports"],function(X,Z){var K=Object.prototype.hasOwnProperty;var P={};var Q=/d{1,2}|'[^']+'|M{1,4}|y{2,4}|h{1,2}|H{1,2}|m{2}|s{2}|S{1,4}|Z{1,2}|z{1,2}|a|:|-|\/|\s+/g;function F(b,a){this.key=b;this.isAge=a}F.types={};for(var Y=["shortAge","longAge","short","long","full","timestamp"],T=0,M=Y.length,J;T<M;T++){J=Y[T];F.types[J]=new F(J,J.toLowerCase().indexOf("age")!==-1)}function C(a,b,c){return b===F.types.shortAge?U(a,c):L(a,c)}function U(a,b){switch(a){case"aMomentAgo":return AJS.I18n.getText("stash.date.format.short.a.moment.ago");case"oneMinuteAgo":return AJS.I18n.getText("stash.date.format.short.one.minute.ago");case"xMinutesAgo":return AJS.I18n.getText("stash.date.format.short.x.minutes.ago",b);case"oneHourAgo":return AJS.I18n.getText("stash.date.format.short.one.hour.ago");case"xHoursAgo":return AJS.I18n.getText("stash.date.format.short.x.hours.ago",b);case"oneDayAgo":return AJS.I18n.getText("stash.date.format.short.one.day.ago");case"xDaysAgo":return AJS.I18n.getText("stash.date.format.short.x.days.ago",b);case"oneWeekAgo":return AJS.I18n.getText("stash.date.format.short.one.week.ago");default:return null}}function L(a,b){switch(a){case"aMomentAgo":return AJS.I18n.getText("stash.date.format.long.a.moment.ago");case"oneMinuteAgo":return AJS.I18n.getText("stash.date.format.long.one.minute.ago");case"xMinutesAgo":return AJS.I18n.getText("stash.date.format.long.x.minutes.ago",b);case"oneHourAgo":return AJS.I18n.getText("stash.date.format.long.one.hour.ago");case"xHoursAgo":return AJS.I18n.getText("stash.date.format.long.x.hours.ago",b);case"oneDayAgo":return AJS.I18n.getText("stash.date.format.long.one.day.ago");case"xDaysAgo":return AJS.I18n.getText("stash.date.format.long.x.days.ago",b);case"oneWeekAgo":return AJS.I18n.getText("stash.date.format.long.one.week.ago");default:return null}}function W(c){if(K.call(P,c)){return P[c]}var a="",b;Q.exec("");while(b=Q.exec(c)){b=b[0];switch(b.charAt(0)){case"'":a+="["+b.substring(1,b.length-1)+"]";break;case"d":case"y":case"a":a+=b.toUpperCase();break;default:a+=b}}P[c]=a;return a}function E(a){switch(a.key){case"short":case"shortAge":return date_format("stash.date.format.short");case"long":case"longAge":return date_format("stash.date.format.long");case"full":return date_format("stash.date.format.full");case"timestamp":return date_format("stash.date.format.timestamp");default:return null}}function R(){var a=document.getElementById("content");if(a){return parseInt(a.getAttribute("data-timezone"),10)}return 0}function D(e,d){var g=typeof d==="number"?d:Z.getTimezoneOffset(),a=Math.abs(g),b=Math.floor(a/60),f=a%60,c="";c+=g<=0?"+":"-";c+=S(b,2,"0");c+=e||"";c+=S(f,2,"0");return c}function S(c,a,b){c=String(c);while(c.length<a){c=b+c}return c}function B(a,c){var b=a.clone(),d=typeof c==="number"?c:Z.getTimezoneOffset();if(a.zone()!==d){b.add("m",a.zone()-d)}return b}function V(c,b){var a=c.clone().add("d",1).hours(0).minutes(0).seconds(0).milliseconds(0).subtract("m",b.zone()-Z.getTimezoneOffset());while(a>c){a.subtract("d",1)}var d=a.clone().subtract("d",1);return d<=b&&b<a}function G(b,a){return Math.floor(a.diff(b,"minutes",true))}function I(c,b){var a=b.diff(c,"hours",true);return Math.round(a)}function A(b,a){return Math.floor(a.diff(b,"days",true))}function O(b,c,e){var f=typeof e==="number"?e:Z.getTimezoneOffset();var d=B(b,f);var a=W(E(c)).replace(/Z+/g,function(g){return"["+D(g.length===1?"":":",f)+"]"});return d.format(a)}function N(b,c,a){a=a||X();if(b<=a){if(b>a.clone().subtract("m",1)){return C("aMomentAgo",c)}else{if(b>a.clone().subtract("m",2)){return C("oneMinuteAgo",c)}else{if(b>a.clone().subtract("m",50)){return C("xMinutesAgo",c,G(b,a))}else{if(b>a.clone().subtract("m",90)){return C("oneHourAgo",c)}else{if(V(a,b)&&b<a.clone().subtract("h",5)){return C("oneDayAgo",c)}else{if(b>a.clone().subtract("d",1)){return C("xHoursAgo",c,I(b,a))}else{if(b>a.clone().subtract("d",7)){return C("xDaysAgo",c,Math.max(A(b,a),2))}else{if(b>a.clone().subtract("d",8)){return C("oneWeekAgo",c)}}}}}}}}}return O(b,c)}function H(b,a){if(b&&a){if(a.isAge){return N(b,a)}else{return O(b,a)}}else{return null}}Z.format=function(b,a){return H(b?X(b):null,F.types[a])};Z.formatDateWithFormatString=O;Z.formatDateWithRelativeAge=N;Z.FormatType=F;Z.getTimezoneOffset=R});